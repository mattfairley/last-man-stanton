var quizApp={};quizApp.key="9314b8803e6b1e173d0c8a52303b82ce",quizApp.name="",quizApp.credits=[],quizApp.moviesLeft=0,quizApp.players=[],quizApp.activePlayer=0,quizApp.totalPlayers=3,quizApp.playersLeft=3,quizApp.lives=1,quizApp.playerEliminated=!1,quizApp.keepPlaying=!0,quizApp.playerNames=["","",""],quizApp.init=function(){quizApp.$setup=$("#setup"),quizApp.$answers=$("#answers"),quizApp.$nameInput=$("#name-input"),quizApp.$random=$("#random-name"),quizApp.$setup=$("div#setup"),quizApp.$play=$("div#play"),quizApp.$reset=$("#reset"),quizApp.$movieInput=$("#movie-input"),quizApp.$guessMovie=$("#guess-movie"),quizApp.$numPlayers=$("#players"),quizApp.$playerNames=$("#player-names"),quizApp.$playerField=$("#setup").find("p.player-number"),quizApp.$lives=$("#lives"),quizApp.$passTurn=$("#pass-turn"),quizApp.$displayTurn=$("#display-turn"),$("button").on("click",function(e){e.preventDefault()}),quizApp.$setup.on("submit",function(e){e.preventDefault(),quizApp.startGame()}),quizApp.$random.on("click",function(){quizApp.randomStart()}),quizApp.$reset.on("click",function(){quizApp.reset()}),quizApp.$guessMovie.on("submit",function(e){e.preventDefault(),quizApp.guessMovie()}),quizApp.$passTurn.on("click",function(){quizApp.pass()}),quizApp.$numPlayers.on("input change",function(){quizApp.changePlayerNum($(this).val())})},quizApp.changePlayerNum=function(e){for(quizApp.$playerNames.html(""),quizApp.totalPlayers=e,quizApp.$playerField.text(e+" players"),1==e&&quizApp.$playerField.text(e+" player"),i=0;e>i;i++)playerNum=Number(i+1),quizApp.playerNames[i]=quizApp.playerNames[i]||"",quizApp.$playerNames.append(""!==quizApp.playerNames[i]?'<li class="player'+playerNum+'"><input type="text" id="player'+playerNum+'-input" class="text-input player-name" placeholder="Player '+playerNum+'\'s name" value="'+quizApp.playerNames[i]+'"></li>':'<li class="player'+playerNum+'"><input type="text" id="player'+playerNum+'-input" class="text-input player-name" placeholder="Player '+playerNum+"'s name\"></li>")},quizApp.setPlayerNames=function(e){var p=e.length;for(i=0;p>i;i++){var a=Number(i+1),s="#player"+a+"-input",u=$(s).val();e[i]=u}},quizApp.setVariables=function(){quizApp.lives=Number(quizApp.$lives.find("input:checked").val()),quizApp.playersLeft=quizApp.totalPlayers,quizApp.moviesLeft=0,quizApp.players=[],quizApp.activePlayer=0,quizApp.credits=[],quizApp.setPlayerNames(quizApp.playerNames)},quizApp.startGame=function(){quizApp.$answers.empty(),quizApp.setVariables(),quizApp.name=quizApp.$nameInput.val(),""!==quizApp.name?(quizApp.activeInput=document.activeElement,quizApp.getName(quizApp.name)):swal("Enter a name!","","error")},quizApp.randomStart=function(){quizApp.$answers.empty(),quizApp.setVariables(),$.ajax({url:"http://api.themoviedb.org/3/person/popular",type:"GET",dataType:"jsonp",data:{api_key:"9314b8803e6b1e173d0c8a52303b82ce",page:1},success:function(e){var p=Math.floor(Math.random()*e.results.length),i=e.results[p].id;quizApp.name=e.results[p].name,swal({title:quizApp.name+"?",text:"Ever heard of them?",type:"info",cancelButtonText:"Nope",confirmButtonText:"Yep",showCancelButton:!0,closeOnCancel:!1},function(e){e?quizApp.getCredits(i):quizApp.randomStart()})}})},quizApp.getName=function(e){$.ajax({url:"http://api.themoviedb.org/3/search/person",type:"GET",dataType:"jsonp",data:{api_key:"9314b8803e6b1e173d0c8a52303b82ce",query:e},success:function(e){if(e.total_results>0){var p=e.results[0].id;quizApp.name=e.results[0].name,quizApp.getCredits(p)}else swal("Whoops!","That name isn't in TMDb. Check your spelling and try again.","error")}})},quizApp.getCredits=function(e){$.ajax({url:"http://api.themoviedb.org/3/person/"+e+"/movie_credits",type:"GET",dataType:"jsonp",data:{api_key:"9314b8803e6b1e173d0c8a52303b82ce"},success:function(e){var p=e.cast;quizApp.parseData(p)}})},quizApp.parseData=function(e){quizApp.credits=[],$.each(e,function(e,p){""!==p.character&&p.release_date&&p.title&&(quizApp.credits.push({title:p.title,year:Number(p.release_date.slice(0,4))}),quizApp.moviesLeft++)}),quizApp.checkLength(),quizApp.credits=quizApp.credits.sort(quizApp.sortByYear),quizApp.updateDOM()},quizApp.checkLength=function(){quizApp.credits.length<10&&swal({title:"Just so you know!",text:"There are only going to be "+quizApp.length+"movies to choose from.",type:"warning"})},quizApp.sortByYear=function(e,p){var i=e.year,a=p.year;return a>i?-1:i>a?1:0},quizApp.clearSetup=function(){$("p.benson").slideUp(function(){quizApp.$setup.fadeOut(function(){quizApp.$nameInput.val(""),quizApp.$play.fadeIn()})}),quizApp.setPlayers(quizApp.totalPlayers),quizApp.playersLeft=quizApp.players.length},quizApp.setPlayers=function(e){for(var p=0;e>p;p++)quizApp.players[p]={playerName:"player"+Number(p+1),playerAlias:quizApp.playerNames[p],lives:quizApp.lives,eliminated:!1},""===quizApp.players[p].playerAlias&&(quizApp.players[p].playerAlias="Player "+Number(p+1))},quizApp.reset=function(){quizApp.$answers.empty(),quizApp.$play.fadeOut(function(){quizApp.$movieInput.val(""),quizApp.$displayTurn.empty(),quizApp.$guessMovie.find("input").removeClass("is-disabled"),quizApp.$passTurn.removeClass("is-disabled"),quizApp.$reset.text("Reset"),quizApp.$setup.fadeIn()})},quizApp.updateDOM=function(){quizApp.clearSetup(),$.each(quizApp.credits,function(e,p){var i=$("<div>").addClass("movie disabled answer"+e).append("<h3>"+p.title+" ("+p.year+")");quizApp.$answers.append(i)}),quizApp.$answers.prepend('<p class="moviesremain">According to TMDb, '+quizApp.name+" has been in "+quizApp.credits.length+' movies.<span class="movies-left"></span></p>'),quizApp.showTurn()},quizApp.guessMovie=function(){quizApp.resetBools(),quizApp.activeInput=document.activeElement,quizApp.movieGuess=quizApp.$movieInput.val(),""!==quizApp.movieGuess?quizApp.compareGuess(quizApp.movieGuess):swal("Enter a guess!","","error")},quizApp.pass=function(){quizApp.resetBools(),quizApp.movieGuess="the movie you couldn't think of",quizApp.compareGuess(quizApp.movieGuess)},quizApp.compareGuess=function(){$.each(quizApp.credits,function(e,p){var i=p.title.toLowerCase(),a=quizApp.movieGuess.toLowerCase();return quizApp.guess=quizApp.stringManipulate(a),quizApp.answer=quizApp.stringManipulate(i),quizApp.guess===quizApp.answer?quizApp.$answers.find("div.answer"+e).hasClass("disabled")?(quizApp.rightAnswer(e),!1):(quizApp.sameAnswer(),!1):e+1===quizApp.credits.length?(quizApp.wrongAnswer(),!1):void 0})},quizApp.stringManipulate=function(e){return e=" "+e+" ",e=e.replace(/(?:(the |a |an ))/,""),e=e.replace(/([&+])/g,"and"),e=e.replace(/(\s-\s)/g," "),e=e.replace(/([^a-zA-Z\d\s])/g,""),e=e.replace(/(\sse7en\s)/g,"seven"),e=e.replace(/(\s1\s)/g," one "),e=e.replace(/(\s2\s)/g," two "),e=e.replace(/(\s3\s)/g," three "),e=e.replace(/(\s4\s)/g," four "),e=e.replace(/(\s5\s)/g," five "),e=e.replace(/(\s6\s)/g," six "),e=e.replace(/(\s7\s)/g," seven "),e=e.replace(/(\s8\s)/g," eight "),e=e.replace(/(\s9\s)/g," nine "),e=e.replace(/(\s10\s)/g," ten "),e=e.replace(/(\s11\s)/g," eleven "),e=e.replace(/(\s12\s)/g," twelve "),e=e.replace(/(\s13\s)/g," thirteen "),e=e.replace(/(\s14\s)/g," fourteen "),e=e.replace(/(\s15\s)/g," fifteen "),e=e.replace(/(\s16\s)/g," sixteen "),e=e.replace(/(\s17\s)/g," seventeen "),e=e.replace(/(\s21\s)/g," twentyone "),e=e.replace(/(\s22\s)/g," twentytwo "),e=e.replace(/(\s30\s)/g," thirty "),e=e.replace(/(\si\s)/g," one "),e=e.replace(/(\sii\s)/g," two "),e=e.replace(/(\siii\s)/g," three "),e=e.replace(/(\siv\s)/g," four "),e=e.replace(/(\sv\s)/g," five "),e=e.replace(/(\svi\s)/g," six "),e=e.replace(/(\svii\s)/g," seven "),e=e.replace(/(\sviii\s)/g," eight "),e=e.replace(/(\six\s)/g," nine "),e=e.replace(/([àáâãäå])/g,"a"),e=e.replace(/([ç])/g,"c"),e=e.replace(/([èéêë])/g,"e"),e=e.replace(/([ìíîï])/g,"i"),e=e.replace(/([ñ])/g,"n"),e=e.replace(/([òóôõö])/g,"o"),e=e.replace(/([ùúûü])/g,"u"),e=e.replace(/([ýÿ])/g,"y"),e=e.replace(/(\s)/g,"")},quizApp.rightAnswer=function(e){quizApp.currentAnswer="correct",quizApp.$answers.find("div.answer"+e).addClass(quizApp.players[quizApp.activePlayer].playerName).insertAfter(quizApp.$answers.find(".moviesremain")).fadeIn(function(){$(this).removeClass("disabled")}),quizApp.moviesLeft--,quizApp.moviesLeft>0?(quizApp.$answers.find(".movies-left").text(" "+quizApp.moviesLeft+" more to go."),quizApp.endTurn()):quizApp.noMoreMovies()},quizApp.wrongAnswer=function(){quizApp.currentAnswer="wrong",quizApp.players[quizApp.activePlayer].lives--,0===quizApp.players[quizApp.activePlayer].lives&&quizApp.eliminatePlayer(),quizApp.endTurn()},quizApp.sameAnswer=function(){quizApp.currentAnswer="same",quizApp.players[quizApp.activePlayer].lives--,0==quizApp.players[quizApp.activePlayer].lives&&quizApp.eliminatePlayer(),quizApp.endTurn()},quizApp.endTurn=function(){quizApp.switchPlayer(),1==quizApp.playersLeft?quizApp.declareWinner():quizApp.showTurn(),quizApp.alerts(),0==quizApp.keepPlaying&&quizApp.gameOver(quizApp.players[quizApp.activePlayer].playerAlias)},quizApp.showTurn=function(){quizApp.$guessMovie.removeClass().addClass(quizApp.players[quizApp.activePlayer].playerName),quizApp.$displayTurn.html(1===quizApp.lives?"It is "+quizApp.players[quizApp.activePlayer].playerAlias+"'s turn.":1==quizApp.players[quizApp.activePlayer].lives?"It is "+quizApp.players[quizApp.activePlayer].playerAlias+'\'s turn. You have <span class="one-life">'+quizApp.players[quizApp.activePlayer].lives+"</span> life left.":"It is "+quizApp.players[quizApp.activePlayer].playerAlias+"'s turn. You have "+quizApp.players[quizApp.activePlayer].lives+" lives left.")},quizApp.eliminatePlayer=function(){quizApp.players[quizApp.activePlayer].eliminated=!0,quizApp.playersLeft--,quizApp.playerEliminated=!0},quizApp.switchPlayer=function(){quizApp.activePlayer;for(quizApp.activePlayer++,quizApp.activePlayer>=quizApp.players.length&&(quizApp.activePlayer=0);quizApp.players[quizApp.activePlayer].eliminated;)quizApp.activePlayer++},quizApp.noMoreMovies=function(){quizApp.keepPlaying=!1},quizApp.declareWinner=function(){quizApp.keepPlaying=!1},quizApp.gameOver=function(e){quizApp.$guessMovie.find("input").addClass("is-disabled"),quizApp.$passTurn.addClass("is-disabled"),quizApp.$displayTurn.text(e+" wins!"),quizApp.$reset.text("Play again?"),quizApp.$answers.find(".disabled").removeClass("disabled");var p=Number(quizApp.credits.length-quizApp.moviesLeft);quizApp.$answers.find(".moviesremain").text("You correctly guessed "+p+" of "+quizApp.name+"'s movies, but missed "+quizApp.moviesLeft+". Scroll down to see them.")},quizApp.alerts=function(){"correct"==quizApp.currentAnswer?swal({title:"Correct!",type:"success",closeOnConfirm:!1},function(){0==quizApp.keepPlaying?swal({title:"No more movies!",text:"You have somehow guessed them all!",type:"success"}):quizApp.nextPlayerAlert()}):"same"==quizApp.currentAnswer?swal({title:"Nope!",text:"Someone already got that one! Pay attention!",type:"error",closeOnConfirm:!1},function(){quizApp.wrongAnswerAlerts()}):swal({title:"Nope!",text:quizApp.name+" is not in "+quizApp.movieGuess,type:"error",closeOnConfirm:!1},function(){quizApp.wrongAnswerAlerts()})},quizApp.wrongAnswerAlerts=function(){quizApp.playerEliminated!==!1?swal({title:"You have been eliminated!",imageUrl:"images/coffin.png",closeOnConfirm:!1},function(){0==quizApp.keepPlaying?swal({title:quizApp.players[quizApp.activePlayer].playerAlias+" wins!",text:"You are the Last Man Stanton!",imageUrl:"images/award.png"}):quizApp.nextPlayerAlert()}):quizApp.nextPlayerAlert()},quizApp.nextPlayerAlert=function(){1==quizApp.players[quizApp.activePlayer].lives&&quizApp.lives>1?swal({title:"Last chance, "+quizApp.players[quizApp.activePlayer].playerAlias+"!",text:"You have one life left.",type:"warning"},function(){quizApp.$movieInput.val("").attr("placeholder",quizApp.players[quizApp.activePlayer].playerAlias+"'s turn!").focus()}):swal({title:""+quizApp.players[quizApp.activePlayer].playerAlias+"'s turn!"},function(){quizApp.$movieInput.val("").attr("placeholder",quizApp.players[quizApp.activePlayer].playerAlias+"'s turn!").focus()})},quizApp.resetBools=function(){quizApp.keepPlaying=!0,quizApp.playerEliminated=!1,quizApp.currentAnswer=""},$(function(){quizApp.init()});